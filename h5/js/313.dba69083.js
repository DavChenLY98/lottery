(self["webpackChunkactivity"]=self["webpackChunkactivity"]||[]).push([[313],{9274:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return T}});var s=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("main",{staticClass:"detail-page"},[e("GoBack"),2===t.info.status?e("Activity",{attrs:{remainder:t.remainder},on:{activityEndFun:t.activityEndFun}}):t._e(),0===t.info.status?e("div",{staticClass:"status-mask"},[e("div",{staticClass:"card-box not-start"},[e("img",{attrs:{src:i(2982),alt:""}}),e("p",[t._v("开始时间")]),e("p",[t._v(t._s(t.info.startTimeStr))])])]):t._e(),1===t.info.status?e("div",{staticClass:"status-mask"},[t._m(0)]):t._e(),e("div",{staticClass:"right-float"},[2===t.info.status?e("p",{on:{click:t.openMyPrizeFun}},[t._v("我的奖品")]):t._e(),e("p",{on:{click:t.toRule}},[t._v("活动规则")])]),e("div",{staticClass:"page-footer",class:1===t.info.status||2===t.info.status?"ended":"not-start"}),e("div",{directives:[{name:"show",rawName:"v-show",value:t.myPrizeFlag,expression:"myPrizeFlag"}],staticClass:"my-prize-mask"},[e("div",{staticClass:"my-prize-cont"},[e("div",{staticClass:"popup-title"},[t._v("我的奖品")]),e("i",{staticClass:"popup-close",on:{click:function(e){t.myPrizeFlag=!1}}}),e("div",{staticClass:"popup-cont-mask"},[t.myPrizeList&&t.myPrizeList.length>0?e("ul",{staticClass:"prize-list"},t._l(t.myPrizeList,(function(i){return e("li",{key:i.id},[e("span",[t._v(t._s(i.name||"-"))]),e("span",[t._v(t._s(i.hittime?i.hittime.slice(0,11):"-"))])])})),0):e("div",{staticClass:"default-page"},[e("p",[t._v("很遗憾，您未中奖")])])])])])],1)},n=[function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"card-box ended"},[e("img",{attrs:{src:i(2130),alt:""}}),e("p",[t._v("活动已结束")])])}],a=i(6318),o=(i(560),i(4582)),r=i(2782),c=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"activity-cont"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.countdownFlag,expression:"countdownFlag"}],staticClass:"countdown-mask"},[e("div",{staticClass:"countdown-cont"},[e("img",{staticClass:"countdown-title",attrs:{src:i(7038),alt:""}}),e("img",{staticClass:"countdown-num",attrs:{src:i(1982)(`./icon-${t.countdownIndex}.png`),alt:""}})])]),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.countdownFlag,expression:"!countdownFlag"}],staticClass:"remainder"},[e("h1",[t._v("剩余时间")]),e("p",[t._v(t._s(t.remainderTime)),e("span",[t._v("s")])])]),t.countdownFlag?t._e():e("div",{ref:"gameCont",staticClass:"game-cont"},t._l(t.gameList,(function(i){return e("div",{key:i.id,staticClass:"envelope-item",style:{left:i.left,transform:`scale(${i.scale}) rotate(${i.rotate}deg)`},on:{click:function(e){return t.receiveFun(i,e)}}})})),0)])},u=[],l=function(t,e,i,s){var n,a=arguments.length,o=a<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(o=(a<3?n(o):a>3?n(e,i,o):n(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o};let d=class extends r.w3{constructor(...t){super(...t),(0,a.Z)(this,"userInfo",{}),(0,a.Z)(this,"countdownFlag",!1),(0,a.Z)(this,"countdownTime",null),(0,a.Z)(this,"countdownIndex",1),(0,a.Z)(this,"gameList",[]),(0,a.Z)(this,"currIndex",1),(0,a.Z)(this,"remainderTime",0),(0,a.Z)(this,"time",null),(0,a.Z)(this,"remainder",void 0)}mounted(){this.getUserInfo()}beforeDestroy(){clearInterval(this.countdownTime),this.countdownTime=null,clearInterval(this.time),this.time=null}getUserInfo(){o.Z.get("/user/info").then((t=>{if(1===t.data.code){const{data:e}=t.data;this.userInfo=e,localStorage.getItem(`${e.id}-${this.$route.query.id}`)?this.gameFun():(this.countdownFun(),localStorage.setItem(`${e.id}-${this.$route.query.id}`,"true"))}else this.$router.push({name:"login"})}))}gameFun(){this.getActivityTime(this.remainder),this.countdownTime=setInterval((()=>{const t=this.currIndex;let e={id:this.currIndex,rotate:Math.floor(100*Math.random()-50),left:Math.floor(600*Math.random())/75+"rem",scale:.65*Math.random()+.65};this.gameList.push(e),setTimeout((()=>{this.gameList=this.gameList.filter((e=>e.id!==t))}),2e3),this.currIndex++}),400)}getActivityTime(t){this.remainderTime=Math.ceil(t/1e3),this.time=setInterval((()=>{this.remainderTime--,0===this.remainderTime&&(clearInterval(this.countdownTime),this.countdownTime=null,clearInterval(this.time),this.time=null,this.$emit("activityEndFun"))}),1e3)}receiveFun(t,e){o.Z.get(`act/go/${this.$route.query.id}`).then((i=>{if(1===i.data.code){const{data:s}=i.data,n=e.target;n.style.animation="";const a=document.getElementsByClassName("game-cont")[0],o=document.createElement("div");o.className="receive-tips",o.style.top=n.offsetTop+"px",o.style.left=n.offsetLeft+"px",o.innerHTML=s.name,a.appendChild(o),setTimeout((()=>{a.removeChild(o)}),1e3),this.gameList=this.gameList.filter((e=>e.id!==t.id))}else this.$router.push({name:"login"})}))}countdownFun(){4==this.countdownIndex?setTimeout((()=>{this.countdownTime=null,this.countdownFlag=!1,this.gameFun()}),1e3):(this.countdownFlag=!0,setTimeout((()=>{this.countdownIndex++,this.countdownFun()}),1e3))}};l([(0,r.fI)()],d.prototype,"remainder",void 0),d=l([r.wA],d);var m=d,h=m,f=i(1001),p=(0,f.Z)(h,c,u,!1,null,"7fbd1f70",null),g=p.exports,v=i(4187),y=i(1602),w=i.n(y),_=function(t,e,i,s){var n,a=arguments.length,o=a<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var r=t.length-1;r>=0;r--)(n=t[r])&&(o=(a<3?n(o):a>3?n(e,i,o):n(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o};let x=class extends r.w3{constructor(...t){super(...t),(0,a.Z)(this,"info",{}),(0,a.Z)(this,"currId",this.$route.query.id),(0,a.Z)(this,"myPrizeFlag",!1),(0,a.Z)(this,"myPrizeList",[]),(0,a.Z)(this,"remainder",0)}mounted(){this.currId?this.getGameInfo():this.$router.push("/")}getGameInfo(){o.Z.get(`/game/info/${this.currId}`).then((t=>{if(1===t.data.code){const{data:e,now:i}=t.data,s=new Date(i).getTime(),n=new Date(e.starttime).getTime(),a=new Date(e.endtime).getTime();this.remainder=a-s,1===e.status&&s>=n&&s<a&&(e.status=2),e.startTimeStr=w()(e.starttime).format("YYYY年MM月DD日 HH:mm:ss"),this.info=e}}))}openMyPrizeFun(){this.myPrizeFlag=!0,o.Z.get("/user/hit/-1/1/100").then((t=>{if(1===t.data.code){const{data:e}=t.data;e.totalNum&&e.items.length>0&&(this.myPrizeList=e.items)}}))}toRule(){this.$router.push({name:"rule",query:{id:this.currId}})}activityEndFun(){this.info.status=1}};x=_([(0,r.wA)({components:{Activity:g,GoBack:v.Z}})],x);var C=x,F=C,I=(0,f.Z)(F,s,n,!1,null,"1ec39d5e",null),T=I.exports},1982:function(t,e,i){var s={"./icon-1.png":5729,"./icon-2.png":1828,"./icon-3.png":4415,"./icon-4.png":5401,"./icon-prize.png":662};function n(t){var e=a(t);return i(e)}function a(t){if(!i.o(s,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return s[t]}n.keys=function(){return Object.keys(s)},n.resolve=a,t.exports=n,n.id=1982},5729:function(t,e,i){"use strict";t.exports=i.p+"img/icon-1.e6fa1d1b.png"},1828:function(t,e,i){"use strict";t.exports=i.p+"img/icon-2.64238b21.png"},4415:function(t,e,i){"use strict";t.exports=i.p+"img/icon-3.74b28fab.png"},5401:function(t,e,i){"use strict";t.exports=i.p+"img/icon-4.0593caf0.png"},662:function(t,e,i){"use strict";t.exports=i.p+"img/icon-prize.9fbfe2ad.png"},7038:function(t,e,i){"use strict";t.exports=i.p+"img/pic-countdown.8bb5471a.png"},2130:function(t,e,i){"use strict";t.exports=i.p+"img/pic-ended.d652870d.png"},2982:function(t,e,i){"use strict";t.exports=i.p+"img/pic-not-start.41b2c748.png"}}]);
//# sourceMappingURL=313.dba69083.js.map